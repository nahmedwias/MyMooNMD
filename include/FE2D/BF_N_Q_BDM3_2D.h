// ***********************************************************************
// P3 BDM vector element, nonconforming , 2D
// History:  23.09.2013 implementation (Markus Wolff)
// ***********************************************************************

// base function values
// vector function, orthonormal to edges, 
// functions 1,2,3, and 4 are orthogonal to edge 1
// functions 5,6,7, and 8 are orthogonal to edge 2
// functions 9,10,11, and 12 are orthogonal to edge 3
// functions 13,14,15, and 16 are orthogonal to edge 4
// functions 17-22 correspond to inner degrees of freedom

// NOTE: If you want to use other evaluation points for degress of freedom on
// the edges of a cell, you also have to change basis functions in
// NF_N_Q_BDM3_2D.h


// coefficient matrix for different choices of the degrees of freedom
// There seems to be no difference in using integral or point evaluation for 
// inner dofs. 

// The dofs on the edges determine the boundary conditions as well. Using 
// Tschebyscheff-points might improve the boundary approximation.

/*
// using equidistant points on edges and point evaluation for inner dofs
static double N_Q_BDM3_2D_CM[484] = {
0.020345052,-0.061035156,0.061035156,-0.020345052,-0.045460391,0.054205247,0.0001929012,-0.050604424,-0.020345052,0.061035156,-0.061035156,0.020345052,0.050604424,-0.0001929012,-0.054205247,0.045460391,0.33333333,0,0.33333333,-0,0.5,0,
0.071289062,-0.055664062,-0.055664062,0.071289062,0.018084491,-0.054253472,0.054253472,-0.018084491,-0.034667969,0.019042969,0.019042969,-0.034667969,-0.018084491,0.054253472,-0.054253472,0.018084491,-0,0.5625,-0,0.28125,0,0.28125,
-0,0,-0,0,-0.032085905,0.22704475,-0.20505401,-0.073238169,0,-0,0,-0,-0.073238169,-0.20505401,0.22704475,-0.032085905,-1.3333333,0,1.3333333,0,0,-0,
-0.23111979,0.38085938,-0.38085938,0.23111979,0,0,0,0,-0.12858073,0.54199219,-0.54199219,0.12858073,0,0,-0,0,0,0,0,-1.125,0,1.125,
-0.18310547,0.54931641,-0.54931641,0.18310547,0.029835391,0.086419753,0.1404321,0.034979424,0.18310547,-0.54931641,0.54931641,-0.18310547,-0.034979424,-0.1404321,-0.086419753,-0.029835391,-0.33333333,0,-0.33333333,0,-0.5,-0,
-0.390625,0.390625,0.390625,-0.390625,0,0,0,0,0.390625,-0.390625,-0.390625,0.390625,0,0,-0,0,0,0,0,0,0,-0,
-0,0,-0,0,0.016460905,-0.086419753,0.34567901,0.057613169,0,-0,0,-0,0.057613169,0.34567901,-0.086419753,0.016460905,1.3333333,0,-1.3333333,0,0,-0,
0.65104167,-1.953125,1.953125,-0.65104167,0,0,0,0,0.65104167,-1.953125,1.953125,-0.65104167,0,0,-0,0,0,0,0,0,0,-0,
0.061035156,-0.18310547,0.18310547,-0.061035156,0.066165124,-0.18460648,0.087384259,-0.093942901,-0.061035156,0.18310547,-0.18310547,0.061035156,0.093942901,-0.087384259,0.18460648,-0.066165124,1,0,1,-0,-1.5,0,
-0.21777344,0.20214844,0.20214844,-0.21777344,0,0,0,0,0.11181641,-0.12744141,-0.12744141,0.11181641,0,0,-0,0,0,1.6875,0,-0.84375,0,-0.84375,
0,-0,0,-0,0.390625,-0.390625,-0.390625,0.390625,-0,0,-0,0,-0.390625,0.390625,0.390625,-0.390625,-0,0,-0,-0,0,0,
-0.055664062,-0.084960938,-0.084960938,-0.055664062,-0.18084491,0.54253472,-0.54253472,0.18084491,0.019042969,0.12158203,0.12158203,0.019042969,0.18084491,-0.54253472,0.54253472,-0.18084491,0,-0.5625,0,-0.28125,-0,-0.28125,
-0,0,-0,0,-0.65104167,1.953125,-1.953125,0.65104167,0,-0,0,-0,-0.65104167,1.953125,-1.953125,0.65104167,-0,0,-0,0,0,-0,
0.20214844,-0.061523438,-0.061523438,0.20214844,0,0,0,0,-0.12744141,0.26806641,0.26806641,-0.12744141,0,0,-0,0,0,-1.6875,0,0.84375,0,0.84375,
-0,0,-0,0,0.026041667,-0.703125,0.703125,-0.026041667,0,-0,0,-0,-0.026041667,0.703125,-0.703125,0.026041667,-0,0,-0,0,0,-0,
0.026041667,-0.703125,0.703125,-0.026041667,0,0,0,0,-0.026041667,0.703125,-0.703125,0.026041667,0,0,-0,0,0,0,0,-0,0,0,
-0.061035156,0.18310547,-0.18310547,0.061035156,-0.040123457,-0.51851852,0.61574074,0.067901235,0.061035156,-0.18310547,0.18310547,-0.061035156,-0.067901235,-0.61574074,0.51851852,0.040123457,-1,0,-1,0,1.5,-0,
0.390625,-0.390625,-0.390625,0.390625,0,0,0,0,0.390625,-0.390625,-0.390625,0.390625,0,0,-0,0,0,0,0,0,0,-0,
-0,0,-0,0,0.390625,-0.390625,-0.390625,0.390625,0,-0,0,-0,0.390625,-0.390625,-0.390625,0.390625,0,0,0,0,-0,-0,
0.20507812,0.32226562,-0.32226562,-0.20507812,0,0,0,0,0.10253906,0.16113281,-0.16113281,-0.10253906,0,0,0,0,0,0,0,1.125,0,-1.125,
0.16276042,-0.48828125,0.48828125,-0.16276042,0,0,0,0,-0.16276042,0.48828125,-0.48828125,0.16276042,0,0,0,0,0,0,0,-0,0,0,
0,-0,0,-0,-0.16276042,0.48828125,-0.48828125,0.16276042,-0,0,-0,0,0.16276042,-0.48828125,0.48828125,-0.16276042,0,0,0,-0,-0,0
};
*/
/*
// using equidistant points on edges and integral evaluation for inner dofs
static double N_Q_BDM3_2D_CM[484] = {
0.032552083,-0.09765625,0.09765625,-0.032552083,-0.1875,0.125,0.125,-0.1875,-0.032552083,0.09765625,-0.09765625,0.032552083,0.1875,-0.125,-0.125,0.1875,0.375,0,-0,0,0,0,
0.1875,-0.125,-0.125,0.1875,0.032552083,-0.09765625,0.09765625,-0.032552083,-0.1875,0.125,0.125,-0.1875,-0.032552083,0.09765625,-0.09765625,0.032552083,-0,0.375,-0,-0,0,0,
-0,0,-0,0,-0.30208333,0.11458333,0.11458333,-0.30208333,0,-0,0,-0,-0.30208333,0.11458333,0.11458333,-0.30208333,-0,-0,1.875,-0,0,0,
-0.57291667,1.40625,-1.40625,0.57291667,0,-0,0,-0,-0.57291667,1.40625,-1.40625,0.57291667,-0,0,-0,0,0,-0,-0,1.125,0,-0,
-0.1953125,0.5859375,-0.5859375,0.1953125,0.171875,0.015625,0.015625,0.171875,0.1953125,-0.5859375,0.5859375,-0.1953125,-0.171875,-0.015625,-0.015625,-0.171875,-0.375,0,0,-0,0,0,
-0.390625,0.390625,0.390625,-0.390625,0,-0,0,-0,0.390625,-0.390625,-0.390625,0.390625,-0,0,-0,0,0,0,-0,0,0,0,
0,-0,0,-0,0.28645833,0.026041667,0.026041667,0.28645833,-0,0,-0,0,0.28645833,0.026041667,0.026041667,0.28645833,0,0,-1.875,0,0,0,
0.65104167,-1.953125,1.953125,-0.65104167,-0,0,-0,0,0.65104167,-1.953125,1.953125,-0.65104167,0,-0,0,-0,0,0,0,-0,0,0,
-0,0,-0,0,0.57291667,-1.40625,1.40625,-0.57291667,0,-0,0,-0,0.57291667,-1.40625,1.40625,-0.57291667,0,0,-0,-0,1.125,0,
-0.30208333,0.11458333,0.11458333,-0.30208333,-0,0,-0,0,-0.30208333,0.11458333,0.11458333,-0.30208333,0,-0,0,-0,0,-0,-0,-0,0,1.875,
-0,0,-0,0,0.390625,-0.390625,-0.390625,0.390625,0,-0,0,-0,-0.390625,0.390625,0.390625,-0.390625,-0,0,0,-0,-0,0,
-0.171875,-0.015625,-0.015625,-0.171875,-0.1953125,0.5859375,-0.5859375,0.1953125,0.171875,0.015625,0.015625,0.171875,0.1953125,-0.5859375,0.5859375,-0.1953125,-0,-0.375,0,0,0,0,
-0,0,-0,0,-0.65104167,1.953125,-1.953125,0.65104167,0,-0,0,-0,-0.65104167,1.953125,-1.953125,0.65104167,0,0,0,-0,0,0,
0.28645833,0.026041667,0.026041667,0.28645833,0,-0,0,-0,0.28645833,0.026041667,0.026041667,0.28645833,-0,0,-0,0,0,0,0,0,-0,-1.875,
-0,0,-0,0,0.026041667,-0.703125,0.703125,-0.026041667,0,-0,0,-0,-0.026041667,0.703125,-0.703125,0.026041667,-0,0,-0,0,0,0,
0.026041667,-0.703125,0.703125,-0.026041667,0,-0,0,-0,-0.026041667,0.703125,-0.703125,0.026041667,-0,0,-0,0,-0,0,-0,-0,0,0,
0,-0,0,-0,-0.546875,0.703125,-0.703125,0.546875,-0,0,-0,0,-0.546875,0.703125,-0.703125,0.546875,-0,-0,0,-0,-1.125,0,
0.390625,-0.390625,-0.390625,0.390625,0,-0,0,-0,0.390625,-0.390625,-0.390625,0.390625,-0,0,-0,0,0,0,0,-0,0,0,
0,-0,0,-0,0.390625,-0.390625,-0.390625,0.390625,-0,0,-0,0,0.390625,-0.390625,-0.390625,0.390625,0,0,-0,0,0,0,
0.546875,-0.703125,0.703125,-0.546875,-0,0,-0,0,0.546875,-0.703125,0.703125,-0.546875,0,-0,0,-0,0,0,0,-1.125,-0,0,
0.16276042,-0.48828125,0.48828125,-0.16276042,0,-0,0,-0,-0.16276042,0.48828125,-0.48828125,0.16276042,-0,0,-0,0,0,0,-0,0,0,0,
0,-0,0,-0,-0.16276042,0.48828125,-0.48828125,0.16276042,-0,0,-0,0,0.16276042,-0.48828125,0.48828125,-0.16276042,0,0,0,0,0,0
};
*/
/*
// using Gauss-Points on edges and point evaluations for inner dofs
static double N_Q_BDM3_2D_CM[484] = {
0.017391891,-0.044051834,0.044051834,-0.017391891,-0.077310535,0.10924949,-0.098399691,-0.12103926,-0.017391891,0.044051834,-0.044051834,0.017391891,0.12103926,0.098399691,-0.10924949,0.077310535,0.625,0,0.625,-0,0.5,0,
0.13020103,-0.067701025,-0.067701025,0.13020103,0.019324323,-0.048946483,0.048946483,-0.019324323,-0.026438789,-0.036061211,-0.036061211,-0.026438789,-0.019324323,0.048946483,-0.048946483,0.019324323,0,0.75,0,0.375,0,0.375,
0,-0,0,-0,-0.058905083,0.29036825,-0.40179567,-0.20466749,-0,0,-0,0,-0.20466749,-0.40179567,0.29036825,-0.058905083,-1.6137431,0,1.6137431,-0,-0,0,
-0.29258269,0.23883804,-0.23883804,0.29258269,0,0,0,0,-0.098018975,0.38284745,-0.38284745,0.098018975,0,0,-0,0,0,0,0,-0.96824584,0,0.96824584,
-0.07536486,0.19089128,-0.19089128,0.07536486,0.054228886,0.038832164,0.24648134,0.097957609,0.07536486,-0.19089128,0.19089128,-0.07536486,-0.097957609,-0.24648134,-0.038832164,-0.054228886,-0.625,-0,-0.625,0,-0.5,-0,
-0.19969052,0.19969052,0.19969052,-0.19969052,0,0,0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,-0,0,0,-0,0,0,0,-0,
-0,0,-0,0,0.035823433,-0.1422866,0.54987732,0.18158584,0,-0,0,-0,0.18158584,0.54987732,-0.1422866,0.035823433,1.6137431,-0,-1.6137431,0,0,-0,
0.23189188,-0.58735779,0.58735779,-0.23189188,0,0,0,0,0.23189188,-0.58735779,0.58735779,-0.23189188,0,0,-0,0,0,-0,0,0,0,-0,
0.030123639,-0.076300016,0.076300016,-0.030123639,0.05868289,-0.12185164,-0.089938707,-0.17165207,-0.030123639,0.076300016,-0.076300016,0.030123639,0.17165207,0.089938707,0.12185164,-0.05868289,1.0825318,0,1.0825318,-0,-0.8660254,0,
-0.23396326,0.17146326,0.17146326,-0.23396326,0,0,0,0,0.077323446,-0.13982345,-0.13982345,0.077323446,0,0,-0,0,0,1.2990381,0,-0.64951905,0,-0.64951905,
0,0,-0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,0,0,-0.19969052,0.19969052,0.19969052,-0.19969052,0,0,0,0,0,0,
-0.10711938,-0.080380624,-0.080380624,-0.10711938,-0.077297292,0.19578593,-0.19578593,0.077297292,0.0033571398,0.18414286,0.18414286,0.0033571398,0.077297292,-0.19578593,0.19578593,-0.077297292,0,-0.75,0,-0.375,0,-0.375,
0,0,0,0,-0.23189188,0.58735779,-0.58735779,0.23189188,0,0,0,0,-0.23189188,0.58735779,-0.58735779,0.23189188,0,0,0,0,0,0,
0.21088161,-0.023381611,-0.023381611,0.21088161,0,0,0,0,-0.1004051,0.2879051,0.2879051,-0.1004051,0,0,-0,0,0,-1.2990381,0,0.64951905,0,0.64951905,
0,0,0,0,0.026803712,-0.43555855,0.43555855,-0.026803712,0,0,0,0,-0.026803712,0.43555855,-0.43555855,0.026803712,0,0,0,0,0,0,
0.026803712,-0.43555855,0.43555855,-0.026803712,0,0,0,0,-0.026803712,0.43555855,-0.43555855,0.026803712,0,0,-0,0,0,0,0,-0,0,0,
-0.030123639,0.076300016,-0.076300016,0.030123639,-0.031879178,-0.3137069,0.52549725,0.14484835,0.030123639,-0.076300016,0.076300016,-0.030123639,-0.14484835,-0.52549725,0.3137069,0.031879178,-1.0825318,-0,-1.0825318,0,0.8660254,-0,
0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,-0,0,0,-0,0,0,0,-0,
0,0,0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,0,0,0,0,
0.26577898,0.19672051,-0.19672051,-0.26577898,0,0,0,0,0.071215263,0.052711102,-0.052711102,-0.071215263,0,0,-0,0,0,-0,0,0.96824584,0,-0.96824584,
0.057972969,-0.14683945,0.14683945,-0.057972969,0,0,0,0,-0.057972969,0.14683945,-0.14683945,0.057972969,0,0,-0,0,0,0,0,-0,0,0,
0,0,0,0,-0.057972969,0.14683945,-0.14683945,0.057972969,0,0,0,0,0.057972969,-0.14683945,0.14683945,-0.057972969,0,0,0,0,0,0
};
*/
/*
// using Gauss-Points on edges and integral evaluations for inner dofs
static double N_Q_BDM3_2D_CM[484] = {
0.011594594,-0.02936789,0.02936789,-0.011594594,-0.088304433,0.025804433,0.025804433,-0.088304433,-0.011594594,0.02936789,-0.02936789,0.011594594,0.088304433,-0.025804433,-0.025804433,0.088304433,0.375,0,-0,0,-0,0,
0.088304433,-0.025804433,-0.025804433,0.088304433,0.011594594,-0.02936789,0.02936789,-0.011594594,-0.088304433,0.025804433,0.025804433,-0.088304433,-0.011594594,0.02936789,-0.02936789,0.011594594,0,0.375,0,-0,0,-0,
-0,0,-0,0,-0.13178629,-0.055713711,-0.055713711,-0.13178629,0,-0,0,-0,-0.13178629,-0.055713711,-0.055713711,-0.13178629,-0,0,1.875,0,-0,0,
-0.19530083,0.31084274,-0.31084274,0.19530083,0,-0,0,-0,-0.19530083,0.31084274,-0.31084274,0.19530083,-0,0,-0,0,0,-0,0,1.125,0,0,
-0.069567563,0.17620734,-0.17620734,0.069567563,0.065222784,0.12227722,0.12227722,0.065222784,0.069567563,-0.17620734,0.17620734,-0.069567563,-0.065222784,-0.12227722,-0.12227722,-0.065222784,-0.375,0,0,0,0,0,
-0.19969052,0.19969052,0.19969052,-0.19969052,0,-0,0,-0,0.19969052,-0.19969052,-0.19969052,0.19969052,-0,0,-0,0,0,0,0,0,0,0,
0,-0,0,-0,0.10870464,0.20379536,0.20379536,0.10870464,-0,0,-0,0,0.10870464,0.20379536,0.20379536,0.10870464,0,0,-1.875,0,0,0,
0.23189188,-0.58735779,0.58735779,-0.23189188,0,-0,0,-0,0.23189188,-0.58735779,0.58735779,-0.23189188,-0,0,-0,0,0,0,0,0,0,0,
-0,0,-0,0,0.19530083,-0.31084274,0.31084274,-0.19530083,0,-0,0,-0,0.19530083,-0.31084274,0.31084274,-0.19530083,0,0,-0,0,1.125,0,
-0.13178629,-0.055713711,-0.055713711,-0.13178629,0,-0,0,-0,-0.13178629,-0.055713711,-0.055713711,-0.13178629,-0,0,-0,0,0,0,0,-0,0,1.875,
0,0,-0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,0,0,-0.19969052,0.19969052,0.19969052,-0.19969052,0,0,0,0,0,0,
-0.065222784,-0.12227722,-0.12227722,-0.065222784,-0.069567563,0.17620734,-0.17620734,0.069567563,0.065222784,0.12227722,0.12227722,0.065222784,0.069567563,-0.17620734,0.17620734,-0.069567563,-0,-0.375,0,0,0,0,
0,0,0,0,-0.23189188,0.58735779,-0.58735779,0.23189188,0,0,0,0,-0.23189188,0.58735779,-0.58735779,0.23189188,0,0,0,0,0,0,
0.10870464,0.20379536,0.20379536,0.10870464,-0,0,-0,0,0.10870464,0.20379536,0.20379536,0.10870464,0,-0,0,-0,0,-0,0,0,0,-1.875,
0,0,0,0,0.026803712,-0.43555855,0.43555855,-0.026803712,0,0,0,0,-0.026803712,0.43555855,-0.43555855,0.026803712,0,0,0,0,0,0,
0.026803712,-0.43555855,0.43555855,-0.026803712,0,-0,0,-0,-0.026803712,0.43555855,-0.43555855,0.026803712,-0,0,-0,0,0,0,0,0,0,0,
0,-0,0,-0,-0.16849712,-0.12471581,0.12471581,0.16849712,-0,0,-0,0,-0.16849712,-0.12471581,0.12471581,0.16849712,-0,-0,0,0,-1.125,0,
0.19969052,-0.19969052,-0.19969052,0.19969052,0,-0,0,-0,0.19969052,-0.19969052,-0.19969052,0.19969052,-0,0,-0,0,-0,0,0,-0,0,0,
0,0,0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,0,0,0,0,0.19969052,-0.19969052,-0.19969052,0.19969052,-0,0,0,0,0,0,
0.16849712,0.12471581,-0.12471581,-0.16849712,0,-0,0,-0,0.16849712,0.12471581,-0.12471581,-0.16849712,-0,0,-0,0,0,0,0,-1.125,0,0,
0.057972969,-0.14683945,0.14683945,-0.057972969,0,-0,0,-0,-0.057972969,0.14683945,-0.14683945,0.057972969,-0,0,-0,0,0,0,0,0,0,0,
0,0,0,0,-0.057972969,0.14683945,-0.14683945,0.057972969,0,0,0,0,0.057972969,-0.14683945,0.14683945,-0.057972969,0,0,0,0,0,0
};
*/

// using Tschebyscheff-points on edges and point evaluations for inner dofs
static double N_Q_BDM3_2D_CM[484] = {
0.0179382859,-0.0433068531,0.0433068531,-0.0179382859,-0.1103852041,0.16786576,-0.1785890647,-0.2538914912,-0.0179382859,0.0433068531,-0.0433068531,0.0179382859,0.2538914912,0.1785890647,-0.16786576,0.1103852041,1,0,1,0,0.5,0,
0.2004441738,-0.0754441738,-0.0754441738,0.2004441738,0.0239177145,-0.0577424708,0.0577424708,-0.0239177145,-0.0129441738,-0.1120558262,-0.1120558262,-0.0129441738,-0.0239177145,0.0577424708,-0.0577424708,0.0239177145,0,1,0,0.5,0,0.5,
0,0,0,0,-0.0845466315,0.3628281139,-0.5610514186,-0.4672300638,0,0,0,0,-0.4672300638,-0.5610514186,0.3628281139,-0.0845466315,-2.3094010768,0,2.3094010768,0,0,0,
-0.4223115993,0.2309698831,-0.2309698831,0.4223115993,0,0,0,0,-0.0956708581,0.3662689082,-0.3662689082,0.0956708581,0,0,0,0,0,0,0,-1.1547005384,0,1.1547005384,
-0.0657737149,0.1587917947,-0.1587917947,0.0657737149,0.0844968564,-0.0169774123,0.3294774123,0.2280031436,0.0657737149,-0.1587917947,0.1587917947,-0.0657737149,-0.2280031436,-0.3294774123,0.0169774123,-0.0844968564,-1,0,-1,0,-0.5,0,
-0.1767766953,0.1767766953,0.1767766953,-0.1767766953,0,0,0,0,0.1767766953,-0.1767766953,-0.1767766953,0.1767766953,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.0586582838,-0.2119397663,0.7119397663,0.4413417162,0,0,0,0,0.4413417162,0.7119397663,-0.2119397663,0.0586582838,2.3094010768,0,-2.3094010768,0,0,0,
0.1913417162,-0.4619397663,0.4619397663,-0.1913417162,0,0,0,0,0.1913417162,-0.4619397663,0.4619397663,-0.1913417162,0,0,0,0,0,0,0,0,0,0,
0.0253685672,-0.061245139,0.061245139,-0.0253685672,0.0645626054,-0.1185718487,-0.1465931943,-0.3297276483,-0.0253685672,0.061245139,-0.061245139,0.0253685672,0.3297276483,0.1465931943,0.1185718487,-0.0645626054,1.4142135624,0,1.4142135624,0,-0.7071067812,0,
-0.2941941738,0.1691941738,0.1691941738,-0.2941941738,0,0,0,0,0.0808058262,-0.2058058262,-0.2058058262,0.0808058262,0,0,0,0,0,1.4142135624,0,-0.7071067812,0,-0.7071067812,
0,0,0,0,0.1767766953,-0.1767766953,-0.1767766953,0.1767766953,0,0,0,0,-0.1767766953,0.1767766953,0.1767766953,-0.1767766953,0,0,0,0,0,0,
-0.1745558262,-0.0754441738,-0.0754441738,-0.1745558262,-0.0717531436,0.1732274123,-0.1732274123,0.0717531436,-0.0129441738,0.2629441738,0.2629441738,-0.0129441738,0.0717531436,-0.1732274123,0.1732274123,-0.0717531436,0,-1,0,-0.5,-0,-0.5,
0,0,0,0,-0.1913417162,0.4619397663,-0.4619397663,0.1913417162,0,0,0,0,-0.1913417162,0.4619397663,-0.4619397663,0.1913417162,0,0,0,0,0,0,
0.2683058262,-0.0183058262,-0.0183058262,0.2683058262,0,0,0,0,-0.1066941738,0.3566941738,0.3566941738,-0.1066941738,0,0,0,0,0,-1.4142135624,0,0.7071067812,0,0.7071067812,
0,0,0,0,0.0280213456,-0.3942902537,0.3942902537,-0.0280213456,0,-0,0,-0,-0.0280213456,0.3942902537,-0.3942902537,0.0280213456,0,0,0,0,0,0,
0.0280213456,-0.3942902537,0.3942902537,-0.0280213456,0,0,0,0,-0.0280213456,0.3942902537,-0.3942902537,0.0280213456,0,0,0,0,0,0,0,0,0,0,
-0.0253685672,0.061245139,-0.061245139,0.0253685672,-0.0365412598,-0.2757184051,0.540883448,0.3017063028,0.0253685672,-0.061245139,0.061245139,-0.0253685672,-0.3017063028,-0.540883448,0.2757184051,0.0365412598,-1.4142135624,-0,-1.4142135624,0,0.7071067812,-0,
0.1767766953,-0.1767766953,-0.1767766953,0.1767766953,0,0,0,0,0.1767766953,-0.1767766953,-0.1767766953,0.1767766953,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.1767766953,-0.1767766953,-0.1767766953,0.1767766953,0,0,0,0,0.1767766953,-0.1767766953,-0.1767766953,0.1767766953,0,0,0,0,0,0,
0.3942902537,0.1633203706,-0.1633203706,-0.3942902537,0,0,0,0,0.0676495125,0.0280213456,-0.0280213456,-0.0676495125,0,0,0,0,0,0,0,1.1547005384,0,-1.1547005384,
0.047835429,-0.1154849416,0.1154849416,-0.047835429,0,0,0,0,-0.047835429,0.1154849416,-0.1154849416,0.047835429,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.047835429,0.1154849416,-0.1154849416,0.047835429,0,0,0,0,0.047835429,-0.1154849416,0.1154849416,-0.047835429,0,0,0,0,0,0
};

/*
// using Tschebyscheff-points on edges and integral evaluations for inner dofs
static double N_Q_BDM3_2D_CM[484] = {
0.0095670858,-0.023096988,0.023096988,-0.0095670858,-0.075444174,0.012944174,0.012944174,-0.075444174,-0.0095670858,0.023096988,-0.023096988,0.0095670858,0.075444174,-0.012944174,-0.012944174,0.075444174,0.375,0,-0,0,-0,0,
0.075444174,-0.012944174,-0.012944174,0.075444174,0.0095670858,-0.023096988,0.023096988,-0.0095670858,-0.075444174,0.012944174,0.012944174,-0.075444174,-0.0095670858,0.023096988,-0.023096988,0.0095670858,-0,0.375,0,-0,0,-0,
-0,0,-0,0,-0.10848139,-0.079018609,-0.079018609,-0.10848139,0,-0,0,-0,-0.10848139,-0.079018609,-0.079018609,-0.10848139,-0,-0,1.875,0,0,0,
-0.15819687,0.21860066,-0.21860066,0.15819687,-0,0,-0,0,-0.15819687,0.21860066,-0.21860066,0.15819687,0,-0,0,-0,0,0,0,1.125,0,0,
-0.057402515,0.13858193,-0.13858193,0.057402515,0.049555826,0.13794417,0.13794417,0.049555826,0.057402515,-0.13858193,0.13858193,-0.057402515,-0.049555826,-0.13794417,-0.13794417,-0.049555826,-0.375,0,0,0,0,0,
-0.1767767,0.1767767,0.1767767,-0.1767767,0,0,0,0,0.1767767,-0.1767767,-0.1767767,0.1767767,0,0,0,0,0,-0,0,0,0,0,
0,-0,0,-0,0.082593044,0.22990696,0.22990696,0.082593044,-0,0,-0,0,0.082593044,0.22990696,0.22990696,0.082593044,0,0,-1.875,0,0,0,
0.19134172,-0.46193977,0.46193977,-0.19134172,0,-0,0,-0,0.19134172,-0.46193977,0.46193977,-0.19134172,-0,0,-0,0,-0,0,0,0,0,0,
-0,0,-0,0,0.15819687,-0.21860066,0.21860066,-0.15819687,0,-0,0,-0,0.15819687,-0.21860066,0.21860066,-0.15819687,-0,0,-0,0,1.125,0,
-0.10848139,-0.079018609,-0.079018609,-0.10848139,-0,0,-0,0,-0.10848139,-0.079018609,-0.079018609,-0.10848139,0,-0,0,-0,0,0,0,-0,0,1.875,
0,0,-0,0,0.1767767,-0.1767767,-0.1767767,0.1767767,0,0,0,0,-0.1767767,0.1767767,0.1767767,-0.1767767,0,0,0,0,0,0,
-0.049555826,-0.13794417,-0.13794417,-0.049555826,-0.057402515,0.13858193,-0.13858193,0.057402515,0.049555826,0.13794417,0.13794417,0.049555826,0.057402515,-0.13858193,0.13858193,-0.057402515,0,-0.375,0,0,0,0,
0,0,-0,0,-0.19134172,0.46193977,-0.46193977,0.19134172,0,0,0,0,-0.19134172,0.46193977,-0.46193977,0.19134172,0,0,0,0,0,0,
0.082593044,0.22990696,0.22990696,0.082593044,0,-0,0,-0,0.082593044,0.22990696,0.22990696,0.082593044,-0,0,-0,0,-0,0,0,0,0,-1.875,
0,0,-0,0,0.028021346,-0.39429025,0.39429025,-0.028021346,0,0,0,0,-0.028021346,0.39429025,-0.39429025,0.028021346,0,0,0,0,0,0,
0.028021346,-0.39429025,0.39429025,-0.028021346,0,0,0,0,-0.028021346,0.39429025,-0.39429025,0.028021346,0,0,0,0,0,0,0,0,0,0,
0,-0,0,-0,-0.13017553,-0.17568959,0.17568959,0.13017553,-0,0,-0,0,-0.13017553,-0.17568959,0.17568959,0.13017553,0,0,0,0,-1.125,0,
0.1767767,-0.1767767,-0.1767767,0.1767767,0,0,0,0,0.1767767,-0.1767767,-0.1767767,0.1767767,0,-0,0,0,0,-0,0,-0,0,0,
0,0,0,0,0.1767767,-0.1767767,-0.1767767,0.1767767,0,0,0,0,0.1767767,-0.1767767,-0.1767767,0.1767767,0,0,0,0,0,0,
0.13017553,0.17568959,-0.17568959,-0.13017553,-0,0,-0,0,0.13017553,0.17568959,-0.17568959,-0.13017553,0,-0,0,-0,0,-0,0,-1.125,0,0,
0.047835429,-0.11548494,0.11548494,-0.047835429,0,0,0,0,-0.047835429,0.11548494,-0.11548494,0.047835429,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.047835429,0.11548494,-0.11548494,0.047835429,0,0,0,0,0.047835429,-0.11548494,0.11548494,-0.047835429,0,0,0,0,0,0
};
*/

static void N_Q_BDM3_2D_Funct(double xi, double eta, double *values)
{
  int nBF = 22; // number of basis functions
  // monomials x-component and y-component
  double mon_x[22]={1,0,xi, 0,xi*xi,    0,xi*xi*xi,       0,eta,  0,eta*eta,      0,eta*eta*eta,          0,
		  xi*eta,     0,xi*xi*eta,        0,xi*eta*eta,         0,    xi*xi*xi*xi,4*xi*eta*eta*eta};
  double mon_y[22]={0,1, 0,xi,    0,xi*xi,       0,xi*xi*xi,  0,eta,      0,eta*eta,          0,eta*eta*eta,
		       0,xi*eta,        0,xi*xi*eta,         0,xi*eta*eta,-4*xi*xi*xi*eta,-eta*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of the derivatives in xi direction
static void N_Q_BDM3_2D_DeriveXi(double xi, double eta, double *values)
{
  int nBF = 22; // number of basis functions
  // monomials x-component and y-component
  double mon_x[22]={0,0,1, 0,2*xi,    0,3*xi*xi,       0,0,  0,0,      0,0,          0,
		  eta,     0,2*xi*eta,        0,eta*eta,         0,    4*xi*xi*xi,4*eta*eta*eta};
  double mon_y[22]={0,0, 0,1,    0,2*xi,       0,3*xi*xi,  0,0,      0,0,          0,0,
		       0,eta,        0,2*xi*eta,         0,eta*eta,-12*xi*xi*eta,0};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of the derivatives in eta direction
static void N_Q_BDM3_2D_DeriveEta(double xi, double eta, double *values)
{
  int nBF = 22; // number of basis functions
  // monomials x-component and y-component
  double mon_x[22]={0,0,0, 0,0,    0,0,       0,1,  0,2*eta,      0,3*eta*eta,          0,
		  xi,     0,xi*xi,        0,2*xi*eta,         0,    0,12*xi*eta*eta};
  double mon_y[22]={0,0, 0,0,    0,0,       0,0,  0,1,      0,2*eta,          0,3*eta*eta,
		       0,xi,        0,xi*xi,         0,2*xi*eta,-4*xi*xi*xi,-4*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of derivatives in xi-xi direction
static void N_Q_BDM3_2D_DeriveXiXi(double xi, double eta, double *values)
{
  int nBF = 22; // number of basis functions
  // monomials x-component and y-component
  double mon_x[22]={0,0,0, 0,2,    0,6*xi,       0,0,  0,0,      0,0,          0,
		  0,     0,2*eta,        0,0,         0,    12*xi*xi,0};
  double mon_y[22]={0,0, 0,0,    0,2,       0,6*xi,  0,0,      0,0,          0,0,
		       0,0,        0,2*eta,         0,0,-24*xi*eta,0};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of derivatives in eta-eta direction
static void N_Q_BDM3_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  int nBF = 22; // number of basis functions
  // monomials x-component and y-component
  double mon_x[22]={0,0,0, 0,0,    0,0,       0,0,  0,2,      0,6*eta,          0,
		  0,     0,0,        0,2*xi,         0,    0,24*xi*eta};
  double mon_y[22]={0,0, 0,0,    0,0,       0,0,  0,0,      0,2,          0,6*eta,
		       0,0,        0,0,         0,2*xi,0,-12*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of derivatives in xi-eta direction
static void N_Q_BDM3_2D_DeriveXiEta(double xi, double eta, double *values)
{
  int nBF = 22; // number of basis functions
  // monomials x-component and y-component
  double mon_x[22]={0,0,0, 0,0,    0,0,       0,0,  0,0,      0,0,          0,
		  1,     0,2*xi,        0,2*eta,         0,    0,12*eta*eta};
  double mon_y[22]={0,0, 0,0,    0,0,       0,0,  0,0,      0,0,          0,0,
		       0,1,        0,2*xi,         0,2*eta,-12*xi*xi,0};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_BDM3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}


// ***********************************************************************

TBaseFunct2D *BF_N_Q_BDM3_2D_Obj = new TBaseFunct2D
        (22, BF_N_Q_BDM3_2D, BFUnitSquare,
         N_Q_BDM3_2D_Funct, N_Q_BDM3_2D_DeriveXi,
         N_Q_BDM3_2D_DeriveEta, N_Q_BDM3_2D_DeriveXiXi,
         N_Q_BDM3_2D_DeriveXiEta, N_Q_BDM3_2D_DeriveEtaEta, 4, 4,
         0, NULL, 2);
